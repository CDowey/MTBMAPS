<HTML>

<HEAD>
  <title>Trail Map Leaflet</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet's CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin="" />

  <!-- Leaflet's Javascipt file -->
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>

  <!-- Add jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

  <!-- Add Leaflet Ajax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

  <style>
    html,
    body {
      height: 100%;
      margin: 0;
    }

    #mapid {
      width: 80%;
      height: 80%;
    }

    #counter {
      table-layout: fixed;
      width: 80%;
      border: 1px solid green;
    }
  </style>

</HEAD>

<BODY>
  <div id="mapid"></div>
  </br>
  <table id="counter">
    <tr>
      <td>Number of Basemap Toggles</td>
      <td></td>
    </tr>
  </table>

  <script>
    // Create Map

    var map = L.map('mapid').setView([44, -72.5], 8);

    // Basemaps
    var Stamen_Toner = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}{r}.{ext}', {
      attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      subdomains: 'abcd',
      minZoom: 0,
      maxZoom: 20,
      ext: 'png'
    }).addTo(map)

    var Thunderforest_Landscape = L.tileLayer('https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey={apikey}', {
      attribution: '&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      apikey: 'eb1937f239cf4794a8edeb744d50d083',
      maxZoom: 22
    });


    var baselayer = {
      'Stamen Basemap': Stamen_Toner,
      'Outdoors Basemap': Thunderforest_Landscape
    }

    // create an operational layer that is empty for now
    let trail1 = L.layerGroup().addTo(map)
    let trail2 = L.layerGroup().addTo(map)

    var myStyle = {
      "color": "#ff7800",
      "weight": 2,
      "opacity": 0.65
    };

    // Read in geoJson from file and add to layerGroup
    var steeple = new L.GeoJSON.AJAX("SteepleZones.geojson");
    trail1.addLayer(steeple)

    var Spruce = new L.GeoJSON.AJAX("Spruce.geojson", {
      onEachFeature: function(feature, layer) {
        layer.bindPopup(feature.properties.name);
      },
      style: myStyle
    });

    trail2.addLayer(Spruce)

    // Create layerControl for layerGroups
    let layerControl = {
      "Steeple Ski": trail1,
      "Spruce": trail2 // an option to show or hide the layer you created from geojson
    }


    L.control.layers(baselayer, layerControl).addTo(map)

    // Update counter to reflect the number of layers on
    var myTable = document.getElementById('counter');
    var count = 0
    myTable.rows[0].cells[1].innerHTML = count;

    map.on('baselayerchange', function(layer, name) {
      count++;
      myTable.rows[0].cells[1].innerHTML = count;
    });


// could use these ifs to count different points for each basemap
    // map.on('baselayerchange', function baselayername(e){
    //   if(map.hasLayer(Stamen_Toner) == true){
    //       var count = 1
    //   }
    //   if(map.hasLayer(Thunderforest_Landscape) == true){
    //       count = 10
    //   }
    //   // if(map.hasLayer(Thunderforest_Landscape) == true){
    //   //     count = 10
    //   // }
    // }
    // );

    // Need to tie this to a trigger (on mouse click or layer on...)


    // if(map.hasLayer(Thunderforest_Landscape) == true){
    //     count = 10
    // }


  </script>

</BODY>

</HTML>
